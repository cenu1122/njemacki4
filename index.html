<!DOCTYPE html>
<html lang="bs">
<head>
  <meta charset="UTF-8" />
  <title>Besplatni Prevodilac</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f4f6f8;
      padding: 20px;
      max-width: 700px;
      margin: auto;
    }
    h1 { text-align: center; }
    textarea {
      width: 100%;
      min-height: 120px;
      padding: 10px;
      margin-top: 10px;
    }
    select, button {
      padding: 10px;
      margin-top: 10px;
    }
    button {
      cursor: pointer;
    }
  </style>
</head>
<body>

<h1>ğŸ¤ğŸŒ Besplatni Prevodilac</h1>

<label>Izaberi ulazni jezik:</label><br>
<select id="sourceLang">
  <option value="en">Engleski</option>
  <option value="de">NjemaÄki</option>
</select>

<textarea id="inputText" placeholder="Govori ili upiÅ¡i tekst..."></textarea>

<br>
<button id="micBtn" onclick="startListening()">ğŸ¤ Govori</button>
<p id="status" style="color:green;font-weight:bold;"></p>
<button onclick="translate()">ğŸŒ Prevedi</button>

<h3>Prevod (Bosanski):</h3>
<textarea id="outputText" readonly></textarea>

<button onclick="speak()">ğŸ”Š PresluÅ¡aj prevod</button>

<script>
// SPEECH TO TEXT
function startListening() {
  const lang = document.getElementById('sourceLang').value;
  const status = document.getElementById('status');

  const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
  if (!SpeechRecognition) {
    status.innerText = 'âŒ Tvoj browser ne podrÅ¾ava govor.';
    return;
  }

  const recognition = new SpeechRecognition();
  recognition.lang = lang === 'en' ? 'en-US' : 'de-DE';
  recognition.interimResults = false;

  status.innerText = 'ğŸ¤ PoÄni govoriti...';

  recognition.start();

  recognition.onresult = function(event) {
    document.getElementById('inputText').value = event.results[0][0].transcript;
    status.innerText = 'âœ… Govor prepoznat.';
  };

  recognition.onerror = function() {
    status.innerText = 'âŒ GreÅ¡ka pri snimanju govora.';
  };

  recognition.onend = function() {
    setTimeout(() => status.innerText = '', 2000);
  };
}
}

// TRANSLATE (FREE LibreTranslate public instance)
async function translate() {
  const text = document.getElementById('inputText').value;
  const source = document.getElementById('sourceLang').value;

  const response = await fetch('https://libretranslate.de/translate', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({
      q: text,
      source: source,
      target: 'bs',
      format: 'text'
    })
  });

  const data = await response.json();
  document.getElementById('outputText').value = data.translatedText;
}

// TEXT TO SPEECH
function speak() {
  const text = document.getElementById('outputText').value;
  const utterance = new SpeechSynthesisUtterance(text);
  utterance.lang = 'bs-BA';
  speechSynthesis.speak(utterance);
}
</script>

</body>
</html>
